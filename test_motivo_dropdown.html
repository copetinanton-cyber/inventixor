<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba - Campo Motivo Lista Desplegable</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .status-badge {
            background: #28a745;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        .test-alert {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <!-- Header -->
        <div class="text-center mb-4">
            <h2 class="text-primary">
                <i class="fas fa-vial me-2"></i>Prueba de Campo Motivo
            </h2>
            <span class="status-badge">‚úÖ Lista Desplegable Implementada</span>
        </div>

        <!-- Alerta informativa -->
        <div class="test-alert">
            <h5><i class="fas fa-info-circle me-2 text-primary"></i>Instrucciones de Prueba:</h5>
            <ol class="mb-0">
                <li>Selecciona diferentes motivos de la lista</li>
                <li>Al seleccionar <strong>"Otro Motivo"</strong>, debe aparecer un campo adicional</li>
                <li>Al cambiar a otro motivo, el campo adicional debe ocultarse</li>
                <li>El campo adicional se vuelve obligatorio cuando est√° visible</li>
            </ol>
        </div>

        <!-- Formulario de prueba -->
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5><i class="fas fa-clipboard-list me-2"></i>Formulario de Devoluci√≥n</h5>
            </div>
            <div class="card-body">
                <form id="testForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Cantidad a Devolver</label>
                                <input type="number" class="form-control" value="1" min="1" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">
                                    <strong>Motivo de Devoluci√≥n</strong> 
                                    <i class="fas fa-star text-warning"></i>
                                </label>
                                <select name="motivo" id="motivo_devolucion" class="form-select" required onchange="toggleMotivoOtro()">
                                    <option value="">Seleccionar motivo...</option>
                                    <optgroup label="üè≠ Problemas de Calidad">
                                        <option value="defecto_fabrica">Defecto de F√°brica</option>
                                        <option value="material_defectuoso">Material Defectuoso</option>
                                        <option value="costura_defectuosa">Costura Defectuosa</option>
                                        <option value="suela_despegada">Suela Despegada</option>
                                        <option value="deformacion">Deformaci√≥n del Producto</option>
                                    </optgroup>
                                    <optgroup label="üì¶ Problemas de Pedido">
                                        <option value="talla_incorrecta">Talla Incorrecta</option>
                                        <option value="color_incorrecto">Color Incorrecto</option>
                                        <option value="modelo_incorrecto">Modelo Incorrecto</option>
                                        <option value="producto_duplicado">Producto Duplicado</option>
                                    </optgroup>
                                    <optgroup label="üë§ Decisiones del Cliente">
                                        <option value="no_gusta_dise√±o">No Gusta el Dise√±o</option>
                                        <option value="cambio_opinion">Cambio de Opini√≥n</option>
                                        <option value="compra_por_error">Compra por Error</option>
                                        <option value="encontro_mejor_precio">Encontr√≥ Mejor Precio</option>
                                    </optgroup>
                                    <optgroup label="üöö Problemas de Entrega">
                                        <option value="entrega_tardia">Entrega Tard√≠a</option>
                                        <option value="da√±ado_envio">Da√±ado en Env√≠o</option>
                                        <option value="empaque_da√±ado">Empaque Da√±ado</option>
                                    </optgroup>
                                    <optgroup label="üõ°Ô∏è Garant√≠a y Otros">
                                        <option value="garantia">Uso de Garant√≠a</option>
                                        <option value="rotura_uso_normal">Rotura por Uso Normal</option>
                                        <option value="producto_incomodo">Producto Inc√≥modo</option>
                                        <option value="otro">Otro Motivo</option>
                                    </optgroup>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Campo adicional para "Otro motivo" -->
                    <div class="row" id="otro-motivo-container" style="display: none;">
                        <div class="col-md-12">
                            <div class="alert alert-warning">
                                <i class="fas fa-magic me-2"></i>
                                <strong>¬°Funciona!</strong> Este campo aparece autom√°ticamente al seleccionar "Otro Motivo"
                            </div>
                            <div class="mb-3">
                                <label class="form-label">
                                    <i class="fas fa-edit me-2"></i>Especifique el Motivo
                                </label>
                                <input type="text" name="motivo_otro_detalle" class="form-control" 
                                       placeholder="Describa el motivo espec√≠fico de la devoluci√≥n...">
                                <div class="form-text">
                                    <i class="fas fa-lightbulb me-1 text-warning"></i>
                                    Este campo es obligatorio cuando est√° visible
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Condici√≥n del Producto</label>
                                <select class="form-select" required>
                                    <option value="">Seleccionar...</option>
                                    <option value="nuevo">Como Nuevo</option>
                                    <option value="usado_bueno">Usado - Buen Estado</option>
                                    <option value="da√±ado">Da√±ado</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Acci√≥n a Realizar</label>
                                <select class="form-select" required>
                                    <option value="">Seleccionar acci√≥n...</option>
                                    <option value="reembolso">Reembolso</option>
                                    <option value="cambio">Cambio por Otro Producto</option>
                                    <option value="reparacion">Reparaci√≥n</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="text-center">
                        <button type="button" class="btn btn-success btn-lg" onclick="probarFormulario()">
                            <i class="fas fa-check me-2"></i>Probar Funcionalidad
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- √Årea de resultado -->
        <div id="resultado" class="mt-4" style="display: none;">
            <div class="alert alert-success">
                <h5><i class="fas fa-check-circle me-2"></i>¬°Test Exitoso!</h5>
                <div id="resultado-detalle"></div>
            </div>
        </div>

        <!-- Estado actual -->
        <div class="mt-4">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h6><i class="fas fa-chart-line me-2"></i>Estado Actual del Campo</h6>
                </div>
                <div class="card-body">
                    <div id="status-info">
                        <p><strong>Motivo Seleccionado:</strong> <span id="current-motivo">Ninguno</span></p>
                        <p><strong>Campo "Otro" Visible:</strong> <span id="otro-visible">No</span></p>
                        <p><strong>Campo "Otro" Requerido:</strong> <span id="otro-required">No</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Funci√≥n para manejar el campo motivo (igual que en el sistema)
        function toggleMotivoOtro() {
            const selectMotivo = document.getElementById('motivo_devolucion');
            const otroContainer = document.getElementById('otro-motivo-container');
            const otroInput = document.querySelector('input[name="motivo_otro_detalle"]');
            
            // Actualizar estado visual
            updateStatus();
            
            if (selectMotivo && otroContainer) {
                if (selectMotivo.value === 'otro') {
                    otroContainer.style.display = 'block';
                    if (otroInput) {
                        otroInput.setAttribute('required', 'required');
                    }
                } else {
                    otroContainer.style.display = 'none';
                    if (otroInput) {
                        otroInput.removeAttribute('required');
                        otroInput.value = '';
                    }
                }
            }
        }

        // Actualizar estado visual
        function updateStatus() {
            const selectMotivo = document.getElementById('motivo_devolucion');
            const otroContainer = document.getElementById('otro-motivo-container');
            const otroInput = document.querySelector('input[name="motivo_otro_detalle"]');
            
            document.getElementById('current-motivo').textContent = 
                selectMotivo.value ? selectMotivo.selectedOptions[0].text : 'Ninguno';
            
            document.getElementById('otro-visible').textContent = 
                otroContainer.style.display === 'block' ? 'S√≠' : 'No';
                
            document.getElementById('otro-required').textContent = 
                otroInput && otroInput.hasAttribute('required') ? 'S√≠' : 'No';
        }

        // Probar formulario
        function probarFormulario() {
            const motivo = document.getElementById('motivo_devolucion').value;
            const motivoTexto = document.getElementById('motivo_devolucion').selectedOptions[0].text;
            const otroDetalle = document.querySelector('input[name="motivo_otro_detalle"]').value;
            
            let resultado = `<strong>Motivo:</strong> ${motivoTexto}<br>`;
            
            if (motivo === 'otro' && otroDetalle) {
                resultado += `<strong>Detalle espec√≠fico:</strong> ${otroDetalle}<br>`;
            }
            
            resultado += `<small class="text-muted">El campo est√° funcionando correctamente como lista desplegable categorizada.</small>`;
            
            document.getElementById('resultado-detalle').innerHTML = resultado;
            document.getElementById('resultado').style.display = 'block';
        }

        // Inicializar estado
        document.addEventListener('DOMContentLoaded', function() {
            updateStatus();
        });
    </script>
</body>
</html>